<!doctype html>
<html lang="da">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Info Scan — v7.3</title>

<style>
  :root{
    --rw-red: #D20014;
    --text: #111;
    --line: #000;
    --weight-green:#059669;
    --weight-yellow:#CA8A04;
    --weight-red:#B91C1C;
    --un-red:#b91c1c;
  }

  body{
    font-family: ui-monospace, monospace;
    margin:0;
    background: var(--rw-red);
    padding:0;
  }

  header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:14px 16px;
    color:white;
    font-size:20px;
    font-weight:700;
  }

  header img{
    height:34px;
  }

  .wrap{
    background:white;
    border-radius:14px;
    padding:16px;
    margin:16px;
  }

  .scannerBox{
    background:#f1f1f1;
    height:260px;
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius:12px;
    margin-bottom:18px;
  }

  .btn{
    width:100%;
    height:54px;
    background:#0d1526;
    border-radius:10px;
    border:0;
    color:white;
    font-size:20px;
    font-weight:700;
    cursor:pointer;
    margin-bottom:30px;
  }

  .title{
    font-size:22px;
    font-weight:700;
    margin-bottom:12px;
    color:#000;
  }

  .dataBox{
    background:white;
    border-radius:12px;
    padding:14px;
    border:2px solid #000;
    margin-bottom:14px;
  }

  .dataBox .head{
    font-weight:700;
    margin-bottom:6px;
    font-size:19px;
  }

  .line{
    width:100%;
    height:2px;
    background:black;
    margin:6px 0 10px 0;
  }

  .row{
    font-size:18px;
    margin-bottom:6px;
  }

  .weight-green{ color:var(--weight-green); font-weight:700; }
  .weight-yellow{ color:var(--weight-yellow); font-weight:700; }
  .weight-red{ color:var(--weight-red); font-weight:700; }

  .un{ color:var(--un-red); font-weight:700; }

  #hazardIcon{
    width:38px;
    position:absolute;
    right:12px;
    bottom:12px;
    display:none;
  }

  .copyBtn{
    width:100%;
    height:54px;
    background:white;
    border:2px solid #000;
    border-radius:10px;
    font-size:20px;
    font-weight:700;
    cursor:pointer;
  }

</style>
</head>

<body>

<header>
  <div>Info Scan — v7.3</div>
  <img src="logo.png" alt="logo">
</header>

<div class="wrap">
  <div class="title">Scanner</div>

  <div id="camera" class="scannerBox">Kamera er slukket</div>

  <button id="scanBtn" class="btn">NY SCANNING</button>
</div>

<div class="wrap">
  <div class="title">Rådata</div>
  <div id="output"></div>
  <img id="hazardIcon" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAiIGhlaWdodD0iMzAiIHZpZXdCb3g9IjAgMCA0MDAgNDAwIiBmaWxsPSJub25lIiBzdHJva2U9IiNkMzJmMmYiIHN0cm9rZS13aWR0aD0iMzUiPjxwb2x5Z29uIHBvaW50cz0iMjAwLDIwIDM4MCwyMDAgMjAwLDM4MCAyMCwyMDAiIGZpbGw9IndoaXRlIi8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMjcwIiByPSIzNSIgZmlsbD0iYmxhY2siLz48cmVjdCB4PSIxODIiIHk9IjkwIiB3aWR0aD0iMzYiIGhlaWdodD0iMTQwIiByeD0iMTgiIGZpbGw9ImJsYWNrIi8+PC9zdmc+" />
  
  <button id="copyBtn" class="copyBtn" disabled>KOPIER</button>
</div>

<script>

function esc(str){
  return String(str).replace(/[&<>"]/g, m=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;" }[m]));
}

function colorWeight(val){
  let kg = parseFloat(val.replace("kg","").trim());
  if(isNaN(kg)) return val;
  if(kg <= 15) return `<span class="weight-green">${kg} kg</span>`;
  if(kg <= 30) return `<span class="weight-yellow">${kg} kg (Pas på når du løfter)</span>`;
  return `<span class="weight-red">${kg} kg (Brug hjælpe værktøj til løft)</span>`;
}

function highlightUN(str){
  return str.replace(/\bUN\d+(?:,\d+)*\b/g, m=>`<span class="un">${m}</span>`);
}

function makeBox(title, rows){
  let html = `<div class="dataBox"><div class="head">${title}</div><div class="line"></div>`;
  rows.forEach(r=> html += `<div class="row">${r}</div>`);
  html += `</div>`;
  return html;
}

document.getElementById("scanBtn").onclick = ()=>{
  startScan();
};

document.getElementById("copyBtn").onclick = ()=>{
  const text = document.getElementById("output").innerText;
  navigator.clipboard.writeText(text);
};

function startScan(){
  // DEMO DATA – VIRKER MED KAMERA PÅ DIN SIDE
  const raw = `
Område: sm
Varenummer: 5456454
Materiale: TEST
Antal: 9 KS på PL
Længde: 1000 mm
Bredde: 6000 mm
Vægt: 10 kg
Areal i m²: 25 m²
Anden info: rør skåle 28/20
htyryyt
Lagerplads: 
Lager/Område: sym01
Reol: 01
Hylde: 02
Plads: 03
Kemi: UN78`;

  renderScan(raw);
}

function renderScan(raw){
  const out = document.getElementById("output");
  out.innerHTML = "";
  document.getElementById("copyBtn").disabled = false;

  let lines = raw.split("\n").map(l=>l.trim()).filter(l=>l !== "");

  let data = {};

  lines.forEach(l=>{
    let p = l.split(":");
    if(p.length >= 2){
      let key = p[0].trim();
      let val = p.slice(1).join(":").trim();
      if(data[key]) data[key] += "\n" + val;
      else data[key] = val;
    }
  });

  let boxes = [

    { title:"Område", keys:["Område"] },
    { title:"Varenummer", keys:["Varenummer"] },
    { title:"Materiale", keys:["Materiale"] },
    { title:"Antal", keys:["Antal"] },

    { title:"Mål", keys:["Længde","Bredde","Tykkelse"] },

    { title:"Vægt", keys:["Vægt"] },

    { title:"Areal i m²", keys:["Areal i m²"] },

    { title:"Anden info", keys:["Anden info"] },

    { title:"Lagerplads", keys:["Lagerplads","Lager/Område","Reol","Hylde","Plads"] },

    { title:"Kemi", keys:["Kemi"] }

  ];

  let hazard = false;

  boxes.forEach(box=>{
    let rows = [];

    box.keys.forEach(k=>{
      if(data[k]){
        let val = esc(data[k]);

        if(k === "Vægt") val = colorWeight(val);
        val = highlightUN(val);

        rows.push(`${k}: ${val}`);

        if(k === "Kemi" && val.includes("UN")) hazard = true;
      }
    });

    if(rows.length){
      out.innerHTML += makeBox(box.title, rows);
    }
  });

  document.getElementById("hazardIcon").style.display = hazard ? "block" : "none";
}

</script>
</body>
</html>
